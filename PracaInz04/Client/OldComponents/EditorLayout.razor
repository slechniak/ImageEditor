@page "/editorlayout"
@inject StateService SService
@inject LocalStorageManager LSManager
@inject IndexedDbManager IDbManager
@inject IndexedDbContext IndexedDbContext
@inject NavigationManager NavigationManager

<div class="editor h-100 d-flex p-0">
    @*<h6 class="font-weight-bold">Editor2Component: @ImageName</h6>*@
    <div class="container-fluid h-100 d-flex border border-2 border-danger">
        <div class="row flex-grow-1 border border-2 border-dark">
            <div class="col-md-8 mh-100 d-flex justify-content-center align-items-center bg-success">
                @if(ImageName!=null && ImageName!="")
                {
                    
                        @*<ImageView2Component></ImageView2Component>*@
                        @*<img class="mw-100 mh-100" src="images/placeholder.svg" alt="Card image cap">*@
                        <img class="mw-100 mh-100" src="images/cat01_500.jpg" alt="Card image cap">
                   
                }
                else
                {
                    <UploadImageComponent></UploadImageComponent>
                    <div class="btn btn-light my-2" @onclick='()=>NavigationManager.NavigateTo("imagelist2")'>Choose image from Image List</div>
                }
            </div>
            <div class="col-md-4 mh-100 bg-primary">
                <Tools2Component></Tools2Component>
            </div>
        </div>
    </div>
</div>

@code {
    // initialize imageName in local storage on startup
    public string? ImageName { get; set; }
    public ImageResized ImageResizedTest { get; set; }

    protected override async Task OnInitializedAsync()
    {
        //ImageName = SService.ImageName;
        var openDbResult = await IndexedDbContext.OpenIndexedDb();
        ImageName = await LSManager.GetImageName();
        if(ImageName != null)
        {
           ImageResizedTest = await IDbManager.FetchImageResized(ImageName);
        }
    }

    protected override void OnAfterRender(bool firstRender)
    {
        Console.WriteLine($"ImageName: {ImageName}");

        base.OnAfterRender(firstRender);
    }

}
